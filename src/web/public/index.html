<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#0a0a0a">
    <title>POLYMARKET ALPHA SCANNER</title>
    <style>
        /* ═══════════════════════════════════════════════════════════════
           TERMINAL STYLE - MATRIX AESTHETICS
           ═══════════════════════════════════════════════════════════════ */
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700&display=swap');

        :root {
            --bg-dark: #0a0a0a;
            --bg-panel: #0f0f0f;
            --bg-card: #141414;
            --border: #1a1a1a;
            --border-light: #2a2a2a;
            --green: #00ff00;
            --green-dim: #00aa00;
            --green-dark: #006600;
            --red: #ff3333;
            --yellow: #ffcc00;
            --cyan: #00ffff;
            --white: #ffffff;
            --gray: #666666;
            --gray-dark: #333333;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'JetBrains Mono', 'Fira Code', 'Consolas', monospace;
            background: var(--bg-dark);
            color: var(--green);
            min-height: 100vh;
            font-size: 12px;
            line-height: 1.4;
            overflow: hidden;
        }

        /* ═══════════════════════════════════════════════════════════════
           MAIN LAYOUT
           ═══════════════════════════════════════════════════════════════ */
        .app {
            display: grid;
            grid-template-columns: 280px 1fr;
            grid-template-rows: 40px 1fr 32px;
            height: 100vh;
            gap: 1px;
            background: var(--border);
        }

        /* ═══════════════════════════════════════════════════════════════
           HEADER BAR
           ═══════════════════════════════════════════════════════════════ */
        .header {
            grid-column: 1 / -1;
            background: var(--bg-panel);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 16px;
            border-bottom: 1px solid var(--border-light);
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 24px;
        }

        .logo {
            font-size: 14px;
            font-weight: 700;
            letter-spacing: 2px;
            color: var(--green);
        }

        .status-indicators {
            display: flex;
            gap: 16px;
        }

        .status-item {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 10px;
            color: var(--gray);
        }

        .status-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: var(--green);
            box-shadow: 0 0 6px var(--green);
        }

        .status-dot.warning { background: var(--yellow); box-shadow: 0 0 6px var(--yellow); }
        .status-dot.error { background: var(--red); box-shadow: 0 0 6px var(--red); }
        .status-dot.inactive { background: var(--gray-dark); box-shadow: none; }

        .header-right {
            display: flex;
            align-items: center;
            gap: 16px;
            font-size: 11px;
            color: var(--gray);
        }

        .clock {
            font-family: inherit;
            color: var(--green-dim);
        }

        /* ═══════════════════════════════════════════════════════════════
           SIDEBAR
           ═══════════════════════════════════════════════════════════════ */
        .sidebar {
            background: var(--bg-panel);
            padding: 16px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .panel {
            background: var(--bg-card);
            border: 1px solid var(--border-light);
            padding: 12px;
        }

        .panel-header {
            font-size: 10px;
            font-weight: 700;
            letter-spacing: 1px;
            color: var(--green);
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--border-light);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .panel-header::before {
            content: '>';
            color: var(--green-dim);
        }

        .panel-row {
            display: flex;
            justify-content: space-between;
            padding: 4px 0;
            font-size: 11px;
        }

        .panel-label {
            color: var(--gray);
        }

        .panel-value {
            color: var(--green);
            font-weight: 500;
        }

        .panel-value.positive { color: var(--green); }
        .panel-value.negative { color: var(--red); }
        .panel-value.warning { color: var(--yellow); }

        /* Progress Bars */
        .progress-container {
            margin-top: 8px;
        }

        .progress-label {
            display: flex;
            justify-content: space-between;
            font-size: 10px;
            margin-bottom: 4px;
        }

        .progress-bar {
            height: 8px;
            background: var(--bg-dark);
            border: 1px solid var(--border-light);
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--green);
            transition: width 0.3s;
        }

        .progress-fill.warning { background: var(--yellow); }
        .progress-fill.danger { background: var(--red); }

        /* Scan Animation */
        .scan-progress {
            display: none;
        }

        .scan-progress.active {
            display: block;
        }

        .scan-bar {
            height: 4px;
            background: var(--bg-dark);
            margin-top: 8px;
            overflow: hidden;
            position: relative;
        }

        .scan-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: -50%;
            width: 50%;
            height: 100%;
            background: linear-gradient(90deg, transparent, var(--green), transparent);
            animation: scan 1.5s infinite;
        }

        @keyframes scan {
            0% { left: -50%; }
            100% { left: 100%; }
        }

        /* ═══════════════════════════════════════════════════════════════
           MAIN CONTENT
           ═══════════════════════════════════════════════════════════════ */
        .main {
            background: var(--bg-panel);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* Tabs */
        .tabs {
            display: flex;
            background: var(--bg-card);
            border-bottom: 1px solid var(--border-light);
        }

        .tab {
            padding: 10px 20px;
            background: none;
            border: none;
            color: var(--gray);
            font-family: inherit;
            font-size: 11px;
            font-weight: 500;
            letter-spacing: 1px;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: all 0.2s;
        }

        .tab:hover {
            color: var(--green-dim);
        }

        .tab.active {
            color: var(--green);
            border-bottom-color: var(--green);
            background: var(--bg-panel);
        }

        /* Tab Content */
        .tab-content {
            flex: 1;
            overflow: hidden;
            display: none;
            flex-direction: column;
        }

        .tab-content.active {
            display: flex;
        }

        /* ═══════════════════════════════════════════════════════════════
           CONSOLE TAB
           ═══════════════════════════════════════════════════════════════ */
        .console {
            flex: 1;
            overflow-y: auto;
            padding: 12px;
            background: var(--bg-dark);
            font-size: 11px;
        }

        .console::-webkit-scrollbar {
            width: 8px;
        }

        .console::-webkit-scrollbar-track {
            background: var(--bg-dark);
        }

        .console::-webkit-scrollbar-thumb {
            background: var(--border-light);
        }

        .log-entry {
            padding: 3px 0;
            display: flex;
            gap: 8px;
            border-bottom: 1px solid var(--border);
        }

        .log-time {
            color: var(--gray);
            flex-shrink: 0;
        }

        .log-level {
            width: 50px;
            flex-shrink: 0;
            font-weight: 500;
        }

        .log-level.info { color: var(--cyan); }
        .log-level.warn { color: var(--yellow); }
        .log-level.error { color: var(--red); }
        .log-level.success { color: var(--green); }
        .log-level.system { color: var(--gray); }

        .log-message {
            color: var(--green-dim);
            word-break: break-word;
        }

        .log-progress {
            display: inline-block;
            margin-left: 8px;
            color: var(--green);
        }

        /* ═══════════════════════════════════════════════════════════════
           MARKETS TAB
           ═══════════════════════════════════════════════════════════════ */
        .markets-container {
            flex: 1;
            overflow-y: auto;
            padding: 12px;
        }

        .market-card {
            background: var(--bg-card);
            border: 1px solid var(--border-light);
            margin-bottom: 8px;
            padding: 12px;
        }

        .market-card.high-alpha {
            border-color: var(--green);
            box-shadow: 0 0 10px rgba(0, 255, 0, 0.1);
        }

        .market-card.german {
            border-left: 3px solid var(--yellow);
        }

        .market-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 8px;
        }

        .market-badges {
            display: flex;
            gap: 6px;
        }

        .badge {
            font-size: 9px;
            padding: 2px 6px;
            background: var(--bg-dark);
            border: 1px solid var(--border-light);
            color: var(--gray);
            letter-spacing: 0.5px;
        }

        .badge.german { border-color: var(--yellow); color: var(--yellow); }
        .badge.high { border-color: var(--green); color: var(--green); }
        .badge.politics { border-color: var(--cyan); color: var(--cyan); }

        .market-score {
            font-size: 18px;
            font-weight: 700;
            color: var(--green);
        }

        .market-question {
            font-size: 12px;
            color: var(--white);
            margin-bottom: 10px;
            line-height: 1.4;
        }

        .market-stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
            margin-bottom: 10px;
            padding: 8px;
            background: var(--bg-dark);
        }

        .market-stat {
            text-align: center;
        }

        .market-stat-label {
            font-size: 9px;
            color: var(--gray);
            margin-bottom: 2px;
        }

        .market-stat-value {
            font-size: 12px;
            font-weight: 500;
        }

        .market-reasoning {
            font-size: 10px;
            color: var(--gray);
            padding: 8px;
            background: var(--bg-dark);
            border-left: 2px solid var(--green-dark);
            margin-bottom: 10px;
        }

        .market-actions {
            display: flex;
            gap: 8px;
        }

        .btn {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid var(--border-light);
            background: var(--bg-dark);
            color: var(--gray);
            font-family: inherit;
            font-size: 10px;
            font-weight: 500;
            letter-spacing: 1px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn:hover {
            border-color: var(--green);
            color: var(--green);
        }

        .btn.primary {
            border-color: var(--green);
            color: var(--green);
        }

        .btn.primary:hover {
            background: var(--green);
            color: var(--bg-dark);
        }

        .btn.danger {
            border-color: var(--red);
            color: var(--red);
        }

        .btn.danger:hover {
            background: var(--red);
            color: var(--bg-dark);
        }

        /* ═══════════════════════════════════════════════════════════════
           RESEARCH TAB
           ═══════════════════════════════════════════════════════════════ */
        .research-container {
            flex: 1;
            overflow-y: auto;
            padding: 12px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            align-content: start;
        }

        .research-section {
            background: var(--bg-card);
            border: 1px solid var(--border-light);
            padding: 12px;
        }

        .research-header {
            font-size: 11px;
            font-weight: 700;
            letter-spacing: 1px;
            color: var(--green);
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--border-light);
        }

        .poll-bar-row {
            display: flex;
            align-items: center;
            margin: 6px 0;
            gap: 8px;
        }

        .poll-party {
            width: 50px;
            font-size: 10px;
            color: var(--gray);
        }

        .poll-bar-bg {
            flex: 1;
            height: 12px;
            background: var(--bg-dark);
            position: relative;
        }

        .poll-bar-fill {
            height: 100%;
            background: var(--green);
            position: relative;
        }

        .poll-bar-fill::after {
            content: '';
            position: absolute;
            right: 0;
            top: 0;
            bottom: 0;
            width: 2px;
            background: var(--green);
            box-shadow: 0 0 4px var(--green);
        }

        .poll-value {
            width: 40px;
            text-align: right;
            font-size: 10px;
            color: var(--green);
        }

        /* Party Colors */
        .poll-cdu .poll-bar-fill { background: #1a1a1a; }
        .poll-cdu .poll-bar-fill::after { background: #666; box-shadow: 0 0 4px #666; }
        .poll-spd .poll-bar-fill { background: #cc0000; }
        .poll-spd .poll-bar-fill::after { background: #ff3333; box-shadow: 0 0 4px #ff3333; }
        .poll-gruene .poll-bar-fill { background: #1a8a2a; }
        .poll-gruene .poll-bar-fill::after { background: #22cc33; box-shadow: 0 0 4px #22cc33; }
        .poll-fdp .poll-bar-fill { background: #ccaa00; }
        .poll-fdp .poll-bar-fill::after { background: #ffdd00; box-shadow: 0 0 4px #ffdd00; }
        .poll-afd .poll-bar-fill { background: #0066aa; }
        .poll-afd .poll-bar-fill::after { background: #00aaff; box-shadow: 0 0 4px #00aaff; }
        .poll-bsw .poll-bar-fill { background: #cc4400; }
        .poll-bsw .poll-bar-fill::after { background: #ff6600; box-shadow: 0 0 4px #ff6600; }
        .poll-linke .poll-bar-fill { background: #8e2856; }
        .poll-linke .poll-bar-fill::after { background: #be3075; box-shadow: 0 0 4px #be3075; }

        .news-item {
            padding: 8px 0;
            border-bottom: 1px solid var(--border);
        }

        .news-source {
            font-size: 9px;
            color: var(--gray);
            margin-bottom: 2px;
        }

        .news-title {
            font-size: 11px;
            color: var(--green-dim);
        }

        .news-link {
            font-size: 9px;
            color: var(--cyan);
            text-decoration: none;
        }

        .news-link:hover {
            text-decoration: underline;
        }

        /* ═══════════════════════════════════════════════════════════════
           FOOTER
           ═══════════════════════════════════════════════════════════════ */
        .footer {
            grid-column: 1 / -1;
            background: var(--bg-card);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 16px;
            border-top: 1px solid var(--border-light);
            font-size: 10px;
        }

        .footer-left {
            color: var(--gray);
        }

        .footer-right {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .scan-btn {
            padding: 6px 16px;
            background: var(--green);
            border: none;
            color: var(--bg-dark);
            font-family: inherit;
            font-size: 10px;
            font-weight: 700;
            letter-spacing: 1px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .scan-btn:hover {
            box-shadow: 0 0 10px var(--green);
        }

        .scan-btn:disabled {
            background: var(--gray-dark);
            color: var(--gray);
            cursor: not-allowed;
            box-shadow: none;
        }

        .scan-btn.scanning {
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        /* ═══════════════════════════════════════════════════════════════
           MODAL
           ═══════════════════════════════════════════════════════════════ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0, 0, 0, 0.85);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.open {
            display: flex;
        }

        .modal-content {
            background: var(--bg-card);
            border: 1px solid var(--green);
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.2);
            max-width: 500px;
            width: 90%;
            padding: 20px;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border-light);
        }

        .modal-title {
            font-size: 12px;
            font-weight: 700;
            letter-spacing: 1px;
            color: var(--green);
        }

        .modal-close {
            background: none;
            border: none;
            color: var(--gray);
            font-size: 18px;
            cursor: pointer;
        }

        .modal-close:hover {
            color: var(--red);
        }

        /* ═══════════════════════════════════════════════════════════════
           ASCII ART LOADER
           ═══════════════════════════════════════════════════════════════ */
        .ascii-loader {
            text-align: center;
            padding: 40px;
            color: var(--green-dim);
            font-size: 11px;
        }

        .ascii-loader pre {
            margin-bottom: 16px;
            line-height: 1.2;
            animation: glow 2s ease-in-out infinite;
        }

        .ascii-loader p {
            animation: blink-cursor 0.8s steps(1) infinite;
        }

        .ascii-loader p::after {
            content: '█';
            animation: cursor-blink 0.5s steps(1) infinite;
        }

        @keyframes glow {
            0%, 100% { text-shadow: 0 0 5px var(--green-dark); color: var(--green-dim); }
            50% { text-shadow: 0 0 20px var(--green), 0 0 30px var(--green-dim); color: var(--green); }
        }

        @keyframes cursor-blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }

        /* ═══════════════════════════════════════════════════════════════
           RESPONSIVE
           ═══════════════════════════════════════════════════════════════ */
        @media (max-width: 1024px) {
            .app {
                grid-template-columns: 1fr;
            }

            .sidebar {
                display: none;
            }

            .research-container {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="app">
        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <span class="logo">EDGY ALPHA SCANNER</span>
                <div class="status-indicators">
                    <div class="status-item">
                        <span class="status-dot" id="api-status"></span>
                        <span>POLYMARKET API</span>
                    </div>
                    <div class="status-item">
                        <span class="status-dot" id="germany-status"></span>
                        <span>ALMANIEN MODUL</span>
                    </div>
                    <div class="status-item">
                        <span class="status-dot" id="socket-status"></span>
                        <span>WEBSOCKET</span>
                    </div>
                </div>
            </div>
            <div class="header-right">
                <span class="clock" id="clock">--:--:--</span>
            </div>
        </header>

        <!-- Sidebar -->
        <aside class="sidebar">
            <!-- System Status -->
            <div class="panel">
                <div class="panel-header">SYSTEM STATUS</div>
                <div class="panel-row">
                    <span class="panel-label">Status</span>
                    <span class="panel-value" id="system-status">ONLINE</span>
                </div>
                <div class="panel-row">
                    <span class="panel-label">Laufzeit</span>
                    <span class="panel-value" id="uptime">00:00:00</span>
                </div>
                <div class="panel-row">
                    <span class="panel-label">Speicher</span>
                    <span class="panel-value" id="memory">--</span>
                </div>
                <div class="panel-row">
                    <span class="panel-label">Letzter Scan</span>
                    <span class="panel-value" id="last-scan">--:--</span>
                </div>
            </div>

            <!-- Scan Config -->
            <div class="panel">
                <div class="panel-header">SCAN KONFIG</div>
                <div class="panel-row">
                    <span class="panel-label">Intervall</span>
                    <span class="panel-value" id="config-interval">5 MIN</span>
                </div>
                <div class="panel-row">
                    <span class="panel-label">Kategorien</span>
                    <span class="panel-value" id="config-categories">POL/ECO</span>
                </div>
                <div class="panel-row">
                    <span class="panel-label">Min. Volumen</span>
                    <span class="panel-value" id="config-volume">$10K</span>
                </div>
                <div class="panel-row">
                    <span class="panel-label">Almanien</span>
                    <span class="panel-value positive" id="config-de">AKTIV</span>
                </div>
            </div>

            <!-- Current Scan -->
            <div class="panel">
                <div class="panel-header">AKTUELLER SCAN</div>
                <div class="panel-row">
                    <span class="panel-label">Märkte</span>
                    <span class="panel-value" id="markets-scanned">0</span>
                </div>
                <div class="panel-row">
                    <span class="panel-label">Signale</span>
                    <span class="panel-value positive" id="signals-found">0</span>
                </div>
                <div class="panel-row">
                    <span class="panel-label">High Alpha</span>
                    <span class="panel-value" id="high-alpha">0</span>
                </div>
                <div class="scan-progress" id="scan-progress">
                    <div class="progress-label">
                        <span>Scanne...</span>
                        <span id="scan-percent">0%</span>
                    </div>
                    <div class="scan-bar"></div>
                </div>
            </div>

            <!-- Performance -->
            <div class="panel">
                <div class="panel-header">PERFORMANCE</div>
                <div class="panel-row">
                    <span class="panel-label">Gewinnrate</span>
                    <span class="panel-value positive" id="win-rate">--</span>
                </div>
                <div class="panel-row">
                    <span class="panel-label">ROI</span>
                    <span class="panel-value" id="roi">--</span>
                </div>
                <div class="panel-row">
                    <span class="panel-label">Trades</span>
                    <span class="panel-value" id="total-trades">0</span>
                </div>
                <div class="progress-container">
                    <div class="progress-label">
                        <span>Wallet (USDC)</span>
                        <span id="wallet-balance">--</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="wallet-bar" style="width: 0%"></div>
                    </div>
                </div>
                <div class="panel-row" style="margin-top: 8px; font-size: 9px;">
                    <span class="panel-label" id="wallet-status">Wallet</span>
                    <span class="panel-value" id="wallet-address">--</span>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main">
            <div class="tabs">
                <button class="tab active" data-tab="console">KONSOLE</button>
                <button class="tab" data-tab="markets">MÄRKTE</button>
                <button class="tab" data-tab="research">ALMANIEN</button>
            </div>

            <!-- Console Tab -->
            <div class="tab-content active" id="tab-console">
                <div class="console" id="console">
                    <div class="ascii-loader" id="initial-loader">
<pre>
███████╗██████╗  ██████╗ ██╗   ██╗     █████╗ ██╗     ██████╗ ██╗  ██╗ █████╗
██╔════╝██╔══██╗██╔════╝ ╚██╗ ██╔╝    ██╔══██╗██║     ██╔══██╗██║  ██║██╔══██╗
█████╗  ██║  ██║██║  ███╗ ╚████╔╝     ███████║██║     ██████╔╝███████║███████║
██╔══╝  ██║  ██║██║   ██║  ╚██╔╝      ██╔══██║██║     ██╔═══╝ ██╔══██║██╔══██║
███████╗██████╔╝╚██████╔╝   ██║       ██║  ██║███████╗██║     ██║  ██║██║  ██║
╚══════╝╚═════╝  ╚═════╝    ╚═╝       ╚═╝  ╚═╝╚══════╝╚═╝     ╚═╝  ╚═╝╚═╝  ╚═╝
               M I T   A L M A N I E N - V O R S P R U N G   v 1 . 0
</pre>
                        <p>System wird initialisiert...</p>
                    </div>
                </div>
            </div>

            <!-- Markets Tab -->
            <div class="tab-content" id="tab-markets">
                <div class="markets-container" id="markets-list">
                    <div class="ascii-loader">
                        <p>> Warte auf Scan-Ergebnisse...</p>
                        <p>> Starte Scan um Alpha-Gelegenheiten zu finden</p>
                    </div>
                </div>
            </div>

            <!-- Research Tab (Almanien) -->
            <div class="tab-content" id="tab-research">
                <div class="research-container">
                    <div class="research-section">
                        <div class="research-header">SONNTAGSFRAGE (DAWUM)</div>
                        <div id="polls-container">
                            <p style="color: var(--gray); font-size: 10px;">Lade Umfragedaten...</p>
                        </div>
                    </div>

                    <div class="research-section">
                        <div class="research-header">BUNDESTAG FEED</div>
                        <div id="bundestag-feed">
                            <p style="color: var(--gray); font-size: 10px;">Lade Gesetzgebungsdaten...</p>
                        </div>
                    </div>

                    <div class="research-section" style="grid-column: 1 / -1;">
                        <div class="research-header">DEUTSCHE NEWS (RSS)</div>
                        <div id="news-feed">
                            <p style="color: var(--gray); font-size: 10px;">Lade Newsfeeds...</p>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="footer">
            <div class="footer-left">
                EDGY ALPHA | Echtzeit-Analyse mit Almanien-Vorsprung
            </div>
            <div class="footer-right">
                <span id="scan-status">BEREIT</span>
                <button class="scan-btn" id="scan-btn">SCAN STARTEN</button>
            </div>
        </footer>
    </div>

    <!-- Trade Modal -->
    <div class="modal" id="trade-modal">
        <div class="modal-content">
            <div class="modal-header">
                <span class="modal-title">TRADE BESTÄTIGEN</span>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <div id="modal-body"></div>
        </div>
    </div>

    <script src="https://cdn.socket.io/4.7.4/socket.io.min.js"></script>
    <script>
        // ═══════════════════════════════════════════════════════════════
        //                        STATE
        // ═══════════════════════════════════════════════════════════════
        let socket = null;
        let isScanning = false;
        let signals = [];
        let startTime = Date.now();

        // ═══════════════════════════════════════════════════════════════
        //                        INIT
        // ═══════════════════════════════════════════════════════════════
        document.addEventListener('DOMContentLoaded', () => {
            initSocket();
            initTabs();
            initClock();
            initUptime();
            loadInitialData();

            // Boot sequence
            setTimeout(() => bootSequence(), 500);
        });

        function bootSequence() {
            const loader = document.getElementById('initial-loader');
            const loaderText = loader.querySelector('p');

            // Boot-Sequenz Texte
            const bootMessages = [
                'Initialisiere Kernel...',
                'Lade Almanien-Module...',
                'Verbinde mit Polymarket...',
                'Kalibriere Alpha-Sensoren...',
                'Aktiviere Vorsprung-Modus...',
            ];

            let msgIndex = 0;
            const msgInterval = setInterval(() => {
                if (msgIndex < bootMessages.length) {
                    loaderText.textContent = bootMessages[msgIndex];
                    msgIndex++;
                }
            }, 800);

            setTimeout(() => {
                clearInterval(msgInterval);
                loader.style.display = 'none';
                addLog('system', '════════════════════════════════════');
                addLog('system', '  EDGY ALPHA v1.1.0 - BOOT COMPLETE');
                addLog('system', '════════════════════════════════════');
            }, 5000);

            setTimeout(() => {
                addLog('info', 'Verbinde mit Polymarket API...');
            }, 5200);

            setTimeout(() => {
                document.getElementById('api-status').classList.remove('inactive');
                addLog('success', 'Polymarket API verbunden');
            }, 5800);

            setTimeout(() => {
                addLog('info', 'Lade Almanien-Datenquellen...');
            }, 6000);

            setTimeout(() => {
                document.getElementById('germany-status').classList.remove('inactive');
                addLog('success', 'Dawum geladen | Bundestag online | RSS aktiv');
            }, 6800);

            setTimeout(() => {
                document.getElementById('socket-status').classList.remove('inactive');
                addLog('success', 'WebSocket Verbindung aktiv');
                addLog('info', '────────────────────────────────────');
                addLog('info', 'Scanner bereit. Warte auf Befehle...');
            }, 7200);
        }

        function initSocket() {
            socket = io();

            socket.on('connect', () => {
                addLog('success', 'WebSocket verbunden');
                document.getElementById('socket-status')?.classList.remove('inactive', 'error');
            });

            socket.on('disconnect', () => {
                addLog('warn', 'WebSocket getrennt');
                document.getElementById('socket-status')?.classList.add('error');
            });

            socket.on('scan_started', () => {
                isScanning = true;
                updateScanUI(true);
                addLog('info', 'Scan gestartet...');
            });

            socket.on('scan_progress', (data) => {
                document.getElementById('scan-percent').textContent = `${data.percent}%`;
                document.getElementById('markets-scanned').textContent = data.markets;
            });

            socket.on('scan_completed', (result) => {
                isScanning = false;
                updateScanUI(false);
                handleScanResult(result);
            });

            socket.on('signal_found', (signal) => {
                addLog('success', `ALPHA GEFUNDEN: ${signal.market.question.substring(0, 50)}...`);
                signals.unshift(signal);
                renderMarkets();
            });

            socket.on('error', (err) => {
                addLog('error', err.message);
            });
        }

        function initTabs() {
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    const tabId = tab.dataset.tab;
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                    tab.classList.add('active');
                    document.getElementById(`tab-${tabId}`).classList.add('active');
                });
            });
        }

        function initClock() {
            function updateClock() {
                const now = new Date();
                document.getElementById('clock').textContent =
                    now.toLocaleTimeString('de-DE', { hour: '2-digit', minute: '2-digit', second: '2-digit' });
            }
            updateClock();
            setInterval(updateClock, 1000);
        }

        function initUptime() {
            setInterval(() => {
                const elapsed = Math.floor((Date.now() - startTime) / 1000);
                const h = Math.floor(elapsed / 3600).toString().padStart(2, '0');
                const m = Math.floor((elapsed % 3600) / 60).toString().padStart(2, '0');
                const s = (elapsed % 60).toString().padStart(2, '0');
                document.getElementById('uptime').textContent = `${h}:${m}:${s}`;
            }, 1000);
        }

        // ═══════════════════════════════════════════════════════════════
        //                        DATA LOADING
        // ═══════════════════════════════════════════════════════════════
        async function loadInitialData() {
            try {
                const opts = { credentials: 'include' };
                const [status, signalsData, polls, news, bundestag, config] = await Promise.all([
                    fetch('/api/status', opts).then(r => r.ok ? r.json() : {}).catch(() => ({})),
                    fetch('/api/signals', opts).then(r => r.ok ? r.json() : []).catch(() => []),
                    fetch('/api/germany/polls', opts).then(r => r.ok ? r.json() : []).catch(() => []),
                    fetch('/api/germany/news', opts).then(r => r.ok ? r.json() : []).catch(() => []),
                    fetch('/api/germany/bundestag', opts).then(r => r.ok ? r.json() : []).catch(() => []),
                    fetch('/api/config', opts).then(r => r.ok ? r.json() : {}).catch(() => ({}))
                ]);

                if (signalsData.length) {
                    signals = signalsData;
                    renderMarkets();
                }

                renderPolls(polls);
                renderNews(news);
                renderBundestag(bundestag);

                // Konfiguration anzeigen
                if (config.scanner) {
                    const interval = Math.round((config.scanner.intervalMs || 300000) / 60000);
                    document.getElementById('config-interval').textContent = `${interval} MIN`;
                    document.getElementById('config-volume').textContent = `$${((config.scanner.minVolumeUsd || 10000) / 1000).toFixed(0)}K`;
                    const cats = config.scanner.categories?.map(c => c.substring(0, 3).toUpperCase()).join('/') || 'POL/ECO';
                    document.getElementById('config-categories').textContent = cats;
                }

                if (config.germany) {
                    document.getElementById('config-de').textContent = config.germany.enabled ? 'AKTIV' : 'INAKTIV';
                    document.getElementById('config-de').className = config.germany.enabled ? 'panel-value positive' : 'panel-value';
                }

                if (status.lastScan) {
                    document.getElementById('last-scan').textContent =
                        new Date(status.lastScan).toLocaleTimeString('de-DE', { hour: '2-digit', minute: '2-digit' });
                }

                // Wallet-Balance laden
                loadWalletBalance();
            } catch (err) {
                addLog('error', 'Fehler beim Laden der Daten');
            }
        }

        async function loadWalletBalance() {
            try {
                const opts = { credentials: 'include' };
                const wallet = await fetch('/api/wallet', opts).then(r => r.json());

                const balanceEl = document.getElementById('wallet-balance');
                const barEl = document.getElementById('wallet-bar');
                const statusEl = document.getElementById('wallet-status');
                const addressEl = document.getElementById('wallet-address');

                if (!wallet.configured) {
                    balanceEl.textContent = 'N/A';
                    balanceEl.style.color = 'var(--gray)';
                    barEl.style.width = '0%';
                    statusEl.textContent = 'Wallet';
                    addressEl.textContent = 'Nicht konfiguriert';
                    addressEl.style.color = 'var(--gray)';
                    addLog('warn', 'Wallet nicht konfiguriert. Trading deaktiviert.');
                } else if (wallet.error) {
                    balanceEl.textContent = 'Fehler';
                    balanceEl.style.color = 'var(--red)';
                    barEl.style.width = '0%';
                    addressEl.textContent = wallet.address || '--';
                    addLog('error', 'Wallet-Fehler: ' + wallet.error);
                } else {
                    balanceEl.textContent = `$${wallet.usdc.toLocaleString('de-DE', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
                    balanceEl.style.color = wallet.usdc > 0 ? 'var(--green)' : 'var(--gray)';
                    // Progress bar basierend auf max 1000 USDC
                    const pct = Math.min((wallet.usdc / 1000) * 100, 100);
                    barEl.style.width = pct + '%';
                    addressEl.textContent = wallet.address;
                    addressEl.style.color = 'var(--green-dim)';
                    addLog('success', `Wallet geladen: $${wallet.usdc.toFixed(2)} USDC | ${wallet.matic.toFixed(4)} MATIC`);
                }
            } catch (err) {
                document.getElementById('wallet-balance').textContent = 'Fehler';
                addLog('error', 'Wallet konnte nicht geladen werden');
            }
        }

        // ═══════════════════════════════════════════════════════════════
        //                        SCANNING
        // ═══════════════════════════════════════════════════════════════
        document.getElementById('scan-btn').addEventListener('click', async () => {
            if (isScanning) return;

            isScanning = true;
            updateScanUI(true);

            addLog('info', '═══════════════════════════════════════');
            addLog('info', 'STARTE MARKT-SCAN');
            addLog('info', '═══════════════════════════════════════');

            try {
                const result = await fetch('/api/scan', { method: 'POST', credentials: 'include' }).then(r => r.json());
                handleScanResult(result);
            } catch (err) {
                addLog('error', 'Scan fehlgeschlagen: ' + err.message);
            } finally {
                isScanning = false;
                updateScanUI(false);
            }
        });

        function updateScanUI(scanning) {
            const btn = document.getElementById('scan-btn');
            const status = document.getElementById('scan-status');
            const progress = document.getElementById('scan-progress');

            if (scanning) {
                btn.disabled = true;
                btn.textContent = 'SCANNE...';
                btn.classList.add('scanning');
                status.textContent = 'SCANNT';
                progress.classList.add('active');
            } else {
                btn.disabled = false;
                btn.textContent = 'SCAN STARTEN';
                btn.classList.remove('scanning');
                status.textContent = 'BEREIT';
                progress.classList.remove('active');
            }
        }

        function handleScanResult(result) {
            const marketsScanned = result.marketsScanned || 0;
            const signalsFound = result.signalsFound || [];
            const highAlpha = signalsFound.filter(s => s.score > 0.7).length;

            document.getElementById('markets-scanned').textContent = marketsScanned;
            document.getElementById('signals-found').textContent = signalsFound.length;
            document.getElementById('high-alpha').textContent = highAlpha;
            document.getElementById('last-scan').textContent =
                new Date().toLocaleTimeString('de-DE', { hour: '2-digit', minute: '2-digit' });

            addLog('info', `${marketsScanned} Märkte gescannt`);
            addLog('success', `${signalsFound.length} Signale gefunden (${highAlpha} High Alpha)`);
            addLog('info', '═══════════════════════════════════════');

            if (signalsFound.length) {
                signals = signalsFound;
                renderMarkets();

                // Wechsle zum Märkte-Tab
                document.querySelector('.tab[data-tab="markets"]').click();
            }
        }

        // ═══════════════════════════════════════════════════════════════
        //                        RENDERING
        // ═══════════════════════════════════════════════════════════════
        function addLog(level, message) {
            const console = document.getElementById('console');
            const loader = document.getElementById('initial-loader');
            if (loader) loader.style.display = 'none';

            const time = new Date().toLocaleTimeString('de-DE');
            const levelText = level.toUpperCase().padEnd(7);

            const entry = document.createElement('div');
            entry.className = 'log-entry';
            entry.innerHTML = `
                <span class="log-time">[${time}]</span>
                <span class="log-level ${level}">${levelText}</span>
                <span class="log-message">${message}</span>
            `;

            console.appendChild(entry);
            console.scrollTop = console.scrollHeight;
        }

        function renderMarkets() {
            const container = document.getElementById('markets-list');

            if (!signals.length) {
                container.innerHTML = `
                    <div class="ascii-loader">
                        <p>> Keine Signale gefunden</p>
                        <p>> Starte Scan um Alpha-Gelegenheiten zu finden</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = signals.map(signal => {
                const isHigh = signal.score > 0.7;
                const isGerman = signal.germanSource !== undefined;

                return `
                    <div class="market-card ${isHigh ? 'high-alpha' : ''} ${isGerman ? 'german' : ''}">
                        <div class="market-header">
                            <div class="market-badges">
                                ${isGerman ? '<span class="badge german">ALMANIEN</span>' : ''}
                                ${isHigh ? '<span class="badge high">HIGH ALPHA</span>' : ''}
                                <span class="badge">${signal.market.category?.toUpperCase() || 'MARKT'}</span>
                            </div>
                            <div class="market-score">${(signal.score * 100).toFixed(0)}%</div>
                        </div>

                        <div class="market-question">${signal.market.question}</div>

                        <div class="market-stats">
                            <div class="market-stat">
                                <div class="market-stat-label">EDGE</div>
                                <div class="market-stat-value" style="color: var(--green)">+${(signal.edge * 100).toFixed(1)}%</div>
                            </div>
                            <div class="market-stat">
                                <div class="market-stat-label">RICHTUNG</div>
                                <div class="market-stat-value">${signal.direction === 'YES' ? 'JA' : 'NEIN'}</div>
                            </div>
                            <div class="market-stat">
                                <div class="market-stat-label">VOLUMEN</div>
                                <div class="market-stat-value">$${(signal.market.volume24h / 1000).toFixed(0)}K</div>
                            </div>
                            <div class="market-stat">
                                <div class="market-stat-label">KELLY</div>
                                <div class="market-stat-value">$${signal.kellyBet?.toFixed(2) || '--'}</div>
                            </div>
                        </div>

                        <div class="market-reasoning">${signal.reasoning}</div>

                        <div class="market-actions">
                            <button class="btn primary" onclick="confirmTrade('${signal.id}', 'YES')">KAUFE JA</button>
                            <button class="btn danger" onclick="confirmTrade('${signal.id}', 'NO')">KAUFE NEIN</button>
                            <button class="btn" onclick="showDetails('${signal.id}')">DETAILS</button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function renderPolls(polls) {
            const container = document.getElementById('polls-container');

            if (!polls || !polls.length) {
                container.innerHTML = '<p style="color: var(--gray); font-size: 10px;">Keine Umfragen verfügbar. Almanien schweigt.</p>';
                return;
            }

            const poll = polls[0];
            // Parteinamen wie sie von der Dawum-API kommen (sortiert nach aktuellem Stärkeverhältnis)
            const parties = ['CDU/CSU', 'AfD', 'SPD', 'Grüne', 'BSW', 'Linke', 'FDP'];
            const partyClasses = ['cdu', 'afd', 'spd', 'gruene', 'bsw', 'linke', 'fdp'];

            // Header mit Datum und Institut
            let html = `<div style="color: var(--gray); font-size: 9px; margin-bottom: 8px;">
                ${poll.institute || 'Unbekannt'} | ${poll.date || '--'}
                <span style="color: var(--green-dim);">// Almanien wird das morgen in der Zeitung lesen</span>
            </div>`;

            html += parties.map((party, i) => {
                const value = poll.results?.[party] || 0;
                if (value === 0) return ''; // Überspringe Parteien ohne Wert
                return `
                    <div class="poll-bar-row poll-${partyClasses[i]}">
                        <span class="poll-party">${party}</span>
                        <div class="poll-bar-bg">
                            <div class="poll-bar-fill" style="width: ${value * 2}%"></div>
                        </div>
                        <span class="poll-value">${value}%</span>
                    </div>
                `;
            }).filter(x => x).join('');

            container.innerHTML = html || '<p style="color: var(--gray); font-size: 10px;">Keine Daten. Almanien produziert gerade Bürokratie.</p>';
        }

        function renderNews(news) {
            const container = document.getElementById('news-feed');

            if (!news || !news.length) {
                container.innerHTML = '<p style="color: var(--gray); font-size: 10px;">Keine News. Almanien produziert gerade Bürokratie statt Nachrichten.</p>';
                return;
            }

            container.innerHTML = news.slice(0, 8).map(item => `
                <div class="news-item">
                    <div class="news-source">${item.data?.source || 'NEWS'}</div>
                    <div class="news-title">${item.title}</div>
                    ${item.url ? `<a href="${item.url}" target="_blank" class="news-link">→ Weiterlesen</a>` : ''}
                </div>
            `).join('');
        }

        function renderBundestag(items) {
            const container = document.getElementById('bundestag-feed');

            if (!items || !items.length) {
                container.innerHTML = `
                    <p style="color: var(--gray); font-size: 10px;">
                        Bundestag API: Kein API-Key konfiguriert.<br>
                        Almanien macht das kostenlos, aber du musst dich registrieren:<br>
                        <a href="https://dip.bundestag.de/" target="_blank" style="color: var(--green);">→ dip.bundestag.de</a>
                    </p>`;
                return;
            }

            container.innerHTML = items.slice(0, 5).map(item => `
                <div class="bundestag-item" style="padding: 6px 0; border-bottom: 1px solid var(--border);">
                    <div style="color: var(--gray); font-size: 9px;">${item.datum || '--'} | ${item.vorgangstyp || 'Vorgang'}</div>
                    <div style="color: var(--green-dim); font-size: 11px; margin-top: 2px;">${item.titel || 'Ohne Titel'}</div>
                </div>
            `).join('');
        }

        // ═══════════════════════════════════════════════════════════════
        //                        TRADING
        // ═══════════════════════════════════════════════════════════════
        function confirmTrade(signalId, direction) {
            const signal = signals.find(s => s.id === signalId);
            if (!signal) return;

            const dirText = direction === 'YES' ? 'JA' : 'NEIN';
            document.getElementById('modal-body').innerHTML = `
                <p style="color: var(--white); margin-bottom: 16px;">${signal.market.question}</p>
                <div style="margin-bottom: 16px; padding: 12px; background: var(--bg-dark);">
                    <div class="panel-row">
                        <span class="panel-label">Richtung</span>
                        <span class="panel-value">${dirText}</span>
                    </div>
                    <div class="panel-row">
                        <span class="panel-label">Edge</span>
                        <span class="panel-value positive">+${(signal.edge * 100).toFixed(1)}%</span>
                    </div>
                    <div class="panel-row">
                        <span class="panel-label">Kelly-Größe</span>
                        <span class="panel-value">$${signal.kellyBet?.toFixed(2) || '--'}</span>
                    </div>
                </div>
                <button class="btn primary" style="width: 100%;" onclick="executeTrade('${signalId}', '${direction}')">
                    TRADE AUSFÜHREN
                </button>
            `;
            document.getElementById('trade-modal').classList.add('open');
        }

        async function executeTrade(signalId, direction) {
            const dirText = direction === 'YES' ? 'JA' : 'NEIN';
            try {
                addLog('info', `Führe ${dirText}-Trade aus...`);
                const response = await fetch(`/api/trade/${signalId}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    credentials: 'include',
                    body: JSON.stringify({ direction })
                });
                const result = await response.json();

                if (result.success) {
                    addLog('success', `Trade ${dirText} vorbereitet`);
                    if (result.note) {
                        addLog('info', result.note);
                    }
                    if (result.balance !== undefined) {
                        addLog('info', `Verfügbar: $${result.balance.toFixed(2)} USDC`);
                    }
                } else {
                    addLog('error', result.error || 'Unbekannter Fehler');
                }
                closeModal();
            } catch (err) {
                addLog('error', 'Trade fehlgeschlagen: ' + err.message);
                closeModal();
            }
        }

        function showDetails(signalId) {
            const signal = signals.find(s => s.id === signalId);
            if (!signal) return;

            document.getElementById('modal-body').innerHTML = `
                <p style="color: var(--white); margin-bottom: 16px;">${signal.market.question}</p>
                <div style="margin-bottom: 16px;">
                    <div class="research-header">ANALYSE</div>
                    <p style="color: var(--gray); font-size: 11px;">${signal.reasoning}</p>
                </div>
                <div style="padding: 12px; background: var(--bg-dark);">
                    <div class="panel-row">
                        <span class="panel-label">Score</span>
                        <span class="panel-value">${(signal.score * 100).toFixed(0)}%</span>
                    </div>
                    <div class="panel-row">
                        <span class="panel-label">Edge</span>
                        <span class="panel-value positive">+${(signal.edge * 100).toFixed(1)}%</span>
                    </div>
                    <div class="panel-row">
                        <span class="panel-label">Volumen 24h</span>
                        <span class="panel-value">$${signal.market.volume24h?.toLocaleString() || '--'}</span>
                    </div>
                    <div class="panel-row">
                        <span class="panel-label">Kategorie</span>
                        <span class="panel-value">${signal.market.category || '--'}</span>
                    </div>
                </div>
            `;
            document.getElementById('trade-modal').classList.add('open');
        }

        function closeModal() {
            document.getElementById('trade-modal').classList.remove('open');
        }

        // Close modal on outside click
        document.getElementById('trade-modal').addEventListener('click', (e) => {
            if (e.target.id === 'trade-modal') closeModal();
        });
    </script>
</body>
</html>
